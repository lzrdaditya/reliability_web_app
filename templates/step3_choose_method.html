<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Step 3: Choose Analysis Method</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f5f7fa; }
        .main-card { max-width: 700px; margin: 48px auto; }
        th { background-color: #f2f2f2; }
        .note { font-size: 0.8em; color: #6c757d; }
        .recommendation { background-color: #e2f0d9; border-left: 5px solid #548235; padding: 10px; margin-top: 15px;}
    </style>
</head>
<body>
<div class="card main-card shadow">
    <div class="card-header bg-dark text-white">
        <h4 class="mb-0">Step 3: Choose Analysis Method</h4>
    </div>
    <div class="card-body">
      
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="alert alert-warning" role="alert">
          {% for message in messages %}
            {{ message }}
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <p>Both methods have been calculated...</p>
    <p>Both methods have been calculated. Below is a statistical comparison to help you choose.</p>
        
        <h5 class="mt-4">Parameter Comparison</h5>
        <table class="table table-bordered">
            <thead>
                <tr><th>Parameter</th><th>MLE</th><th>Rank Regression (RR)</th></tr>
            </thead>
            <tbody>
                <tr><td><strong>Beta (β)</strong></td><td>{{ result_mle.beta }}</td><td>{{ result_rr.beta }}</td></tr>
                <tr><td><strong>Alpha (α)</strong></td><td>{{ result_mle.alpha }}</td><td>{{ result_rr.alpha }}</td></tr>
                <tr><td><strong>Failure Pattern</strong></td><td>{{ result_mle.pattern }}</td><td>{{ result_rr.pattern }}</td></tr>
            </tbody>
        </table>

        <h5 class="mt-4">Goodness-of-Fit Comparison</h5>
        <table class="table table-bordered mb-3">
            <thead>
                <tr><th>Metric</th><th>MLE</th><th>Rank Regression (RR)</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Log-Likelihood</strong> <span class="note">(Higher is better)</span></td>
                    <td>{{ result_mle.loglik }}</td>
                    <td>{{ result_rr.loglik }}</td>
                </tr>
                <tr>
                    <td><strong>AICc</strong> <span class="note">(Lower is better)</span></td>
                    <td>{{ result_mle.AICc }}</td>
                    <td>{{ result_rr.AICc }}</td>
                </tr>
                <tr>
                    <td><strong>Anderson-Darling</strong> <span class="note">(Lower is better)</span></td>
                    <td>{{ result_mle.AD }}</td>
                    <td>{{ result_rr.AD }}</td>
                </tr>
            </tbody>
        </table>

        <div class="recommendation">
            <strong>Recommendation:</strong> {{ recommendation }}
        </div>

        <form method="POST" class="mt-4">
            <div class="form-check">
                <input class="form-check-input" type="radio" name="analysis_method" id="mle_choice" value="mle" {% if recommended_method == 'mle' %}checked{% endif %}>
                <label class="form-check-label" for="mle_choice">
                    Use MLE (Maximum Likelihood Estimation)
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="analysis_method" id="rr_choice" value="rr" {% if recommended_method == 'rr' %}checked{% endif %}>
                <label class="form-check-label" for="rr_choice">
                    Use RR (Rank Regression)
                </label>
            </div>
            <div class="text-end mt-3">
                <button type="submit" class="btn btn-primary">Continue with Selected Method &rarr;</button>
            </div>
        </form>
    </div>
</div>
</body>
</html>